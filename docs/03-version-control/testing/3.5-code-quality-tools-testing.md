# 3.5 Code Quality Tools Configuration 테스트 가이드

## 📋 테스트 개요

**목표**: 코드 품질 도구 설정의 모든 기능이 WSL + Docker 환경에서 정상 작동하는지 검증
**테스트 범위**: Black, isort, flake8, mypy, pre-commit, 자동화 스크립트
**예상 소요 시간**: 45-60분

---

## 🧪 사전 준비

### 환경 설정 확인

```bash
# WSL Ubuntu 환경에서 실행
cd /mnt/c/dev/movie-mlops

# 현재 상태 확인
pwd
git status

# 필요 패키지 설치 확인
pip install -r docs/03-version-control/requirements.txt
pip install -r docs/03-version-control/requirements-dev.txt

# Docker 서비스 확인
sudo service docker start
docker --version

# 가상환경 활성화 확인
echo "Python 경로: $(which python)"
echo "Pip 경로: $(which pip)"
```

---

## 🎯 테스트 시나리오 1: 코드 품질 도구 설치 검증

### 1.1 필수 패키지 설치 확인

```bash
echo "📦 코드 품질 도구 설치 상태 확인..."

# 기본 도구들
tools=(
    "black"
    "isort" 
    "flake8"
    "mypy"
    "bandit"
    "pylint"
    "safety"
    "pre-commit"
)

for tool in "${tools[@]}"; do
    if command -v "$tool" &> /dev/null; then
        version=$($tool --version 2>/dev/null | head -1)
        echo "✅ $tool: $version"
    else
        echo "❌ $tool: 설치되지 않음"
    fi
done

echo ""
echo "🐍 Python 패키지 확인:"
python -c "
import sys
packages = ['black', 'isort', 'flake8', 'mypy', 'bandit', 'pylint', 'safety', 'pre_commit']
for pkg in packages:
    try:
        __import__(pkg.replace('-', '_'))
        print(f'✅ {pkg}: 임포트 가능')
    except ImportError:
        print(f'❌ {pkg}: 임포트 실패')
"
```

### 1.2 설정 파일 존재 확인

```bash
echo "⚙️ 설정 파일 존재 확인..."

# 설정 파일들 확인
config_files=(
    "pyproject.toml"
    ".flake8"
    ".pre-commit-config.yaml"
)

for file in "${config_files[@]}"; do
    if [ -f "$file" ]; then
        echo "✅ $file 존재"
        # 파일 내용 간단 확인
        if [[ "$file" == "pyproject.toml" ]]; then
            if grep -q "\[tool.black\]" "$file"; then
                echo "  └─ Black 설정 포함"
            fi
            if grep -q "\[tool.isort\]" "$file"; then
                echo "  └─ isort 설정 포함"
            fi
            if grep -q "\[tool.mypy\]" "$file"; then
                echo "  └─ MyPy 설정 포함"
            fi
        fi
    else
        echo "❌ $file 없음"
    fi
done
```

---

## 🎯 테스트 시나리오 2: 개별 도구 기능 테스트

### 2.1 테스트용 Python 파일 생성

```bash
echo "📝 테스트용 Python 파일 생성..."

mkdir -p test_quality/src test_quality/tests

# 의도적으로 형식 문제가 있는 파일
cat > test_quality/src/bad_format.py << 'EOF'
import   sys,os
import pandas as pd
from typing import List,Dict

def   poorly_formatted_function(  param1,param2  ):
    """This function has poor formatting"""
    x=1+2
    y=3*4
    if x==3:
        result=param1+param2
        return result
    else:return None

class BadlyFormattedClass:
    def __init__(self,value):
        self.value=value
    def get_value(self  ):
        return self.value

# Unused import and variables
import datetime
unused_var = "not used"
EOF

# 타입 힌트 문제가 있는 파일
cat > test_quality/src/type_issues.py << 'EOF'
def function_without_types(param1, param2):
    return param1 + param2

def function_with_any(param1) -> any:
    return param1

class ClassWithoutTypes:
    def method(self, param):
        return param * 2

def function_with_missing_return():
    x = 1 + 2
    # Missing return statement
EOF

# 보안 문제가 있는 파일
cat > test_quality/src/security_issues.py << 'EOF'
import subprocess
import os

# Security issue: shell injection
def run_command(user_input):
    os.system(f"ls {user_input}")
    
# Security issue: hardcoded password
password = "hardcoded_password_123"

# Security issue: eval usage
def evaluate_expression(expr):
    return eval(expr)
EOF

# 테스트 파일
cat > test_quality/tests/test_example.py << 'EOF'
import pytest
from src.bad_format import poorly_formatted_function

def test_poorly_formatted_function():
    result = poorly_formatted_function(1, 2)
    assert result == 3

def test_with_no_assertion():
    # Test without assertion
    poorly_formatted_function(5, 10)
EOF

echo "✅ 테스트 파일 생성 완료"
```

### 2.2 Black 포맷터 테스트

```bash
echo "🎨 Black 포맷터 테스트..."

# 현재 상태 확인
echo "1. 포맷팅 전 상태 확인:"
black --check test_quality/ || echo "포맷팅 필요한 파일 감지됨"

echo ""
echo "2. 포맷팅 적용:"
black test_quality/

echo ""
echo "3. 포맷팅 후 확인:"
black --check test_quality/
if [ $? -eq 0 ]; then
    echo "✅ Black 포맷팅 테스트 통과"
else
    echo "❌ Black 포맷팅 테스트 실패"
fi

echo ""
echo "4. 포맷팅된 파일 내용 확인:"
echo "--- 포맷팅 후 결과 ---"
head -10 test_quality/src/bad_format.py
```

### 2.3 isort import 정렬 테스트

```bash
echo "📦 isort import 정렬 테스트..."

# isort 적용 전 확인
echo "1. import 정렬 전 상태:"
isort --check-only test_quality/ || echo "import 정렬 필요"

echo ""
echo "2. import 정렬 적용:"
isort test_quality/

echo ""
echo "3. import 정렬 후 확인:"
isort --check-only test_quality/
if [ $? -eq 0 ]; then
    echo "✅ isort 테스트 통과"
else
    echo "❌ isort 테스트 실패"
fi

echo ""
echo "4. 정렬된 import 확인:"
head -5 test_quality/src/bad_format.py
```

### 2.4 flake8 스타일 검사 테스트

```bash
echo "🔍 flake8 스타일 검사 테스트..."

echo "1. 스타일 검사 실행:"
flake8 test_quality/ || echo "스타일 문제 감지됨"

echo ""
echo "2. 특정 규칙 무시 테스트:"
flake8 --ignore=E501,W503 test_quality/ || echo "일부 규칙 무시하고 검사"

echo ""
echo "3. 상세 리포트 생성:"
flake8 --statistics test_quality/ 2>&1 | tail -10

if command -v flake8 &> /dev/null; then
    echo "✅ flake8 테스트 완료"
else
    echo "❌ flake8 테스트 실패"
fi
```

### 2.5 MyPy 타입 체킹 테스트

```bash
echo "🔬 MyPy 타입 체킹 테스트..."

echo "1. 타입 체킹 실행:"
mypy test_quality/src/ || echo "타입 오류 감지됨"

echo ""
echo "2. 설정 파일 기반 체킹:"
if [ -f "pyproject.toml" ]; then
    mypy --config-file pyproject.toml test_quality/src/ || echo "설정 기반 타입 체킹 완료"
else
    echo "pyproject.toml 설정 파일 없음"
fi

echo ""
echo "3. 타입 힌트 개선 후 재테스트:"
# 타입 힌트 개선된 파일 생성
cat > test_quality/src/improved_types.py << 'EOF'
from typing import Optional

def function_with_types(param1: int, param2: int) -> int:
    return param1 + param2

def function_with_optional(param1: str) -> Optional[str]:
    if param1:
        return param1.upper()
    return None

class ClassWithTypes:
    def __init__(self, value: int) -> None:
        self.value = value
    
    def get_value(self) -> int:
        return self.value
EOF

mypy test_quality/src/improved_types.py
if [ $? -eq 0 ]; then
    echo "✅ 개선된 파일 타입 체킹 통과"
else
    echo "⚠️ 타입 체킹에서 일부 이슈 발견"
fi
```

### 2.6 Bandit 보안 검사 테스트

```bash
echo "🔒 Bandit 보안 검사 테스트..."

echo "1. 보안 검사 실행:"
bandit -r test_quality/src/ || echo "보안 이슈 감지됨"

echo ""
echo "2. JSON 형식 리포트 생성:"
bandit -r test_quality/src/ -f json -o test_security_report.json || true

if [ -f "test_security_report.json" ]; then
    echo "✅ 보안 리포트 생성됨"
    echo "보안 이슈 수: $(jq '.results | length' test_security_report.json 2>/dev/null || echo "JSON 파싱 실패")"
else
    echo "❌ 보안 리포트 생성 실패"
fi

echo ""
echo "3. 심각도별 보안 이슈:"
bandit -r test_quality/src/ -f txt | grep -E "(High|Medium|Low)" | head -5 || echo "보안 검사 완료"
```

---

## 🎯 테스트 시나리오 3: Pre-commit Hook 테스트

### 3.1 Pre-commit 설치 및 설정 테스트

```bash
echo "🔗 Pre-commit Hook 테스트..."

echo "1. Pre-commit 설치 확인:"
if [ -f ".pre-commit-config.yaml" ]; then
    echo "✅ .pre-commit-config.yaml 존재"
    
    # pre-commit 설치
    echo "2. Pre-commit hook 설치:"
    pre-commit install
    
    echo ""
    echo "3. 모든 파일에 대한 pre-commit 실행:"
    pre-commit run --all-files || echo "Pre-commit에서 일부 이슈 발견"
    
    echo ""
    echo "4. 특정 hook만 실행 테스트:"
    pre-commit run black || echo "Black hook 실행 완료"
    pre-commit run isort || echo "isort hook 실행 완료"
    pre-commit run flake8 || echo "flake8 hook 실행 완료"
    
else
    echo "❌ .pre-commit-config.yaml 파일이 없습니다"
    echo "Pre-commit 설정을 먼저 생성해주세요"
fi
```

### 3.2 Commit 시나리오 테스트

```bash
echo "💾 Commit 시나리오 테스트..."

# Git 초기화 및 테스트 파일 추가
cd test_quality
git init . 2>/dev/null || true
git add -A

echo "1. 문제가 있는 코드로 커밋 시도:"
git commit -m "test: add code with quality issues" || echo "Pre-commit hook이 커밋을 차단함"

echo ""
echo "2. 코드 품질 개선 후 재시도:"
# 파일들을 다시 포맷팅
black src/
isort src/

git add -A
git commit -m "test: add properly formatted code" || echo "커밋 시도 완료"

cd ..
echo "✅ Commit 시나리오 테스트 완료"
```

---

## 🎯 테스트 시나리오 4: 자동화 스크립트 테스트

### 4.1 품질 검사 스크립트 테스트

```bash
echo "🤖 자동화 스크립트 테스트..."

# 품질 검사 스크립트 존재 확인
if [ -f "scripts/quality-check.sh" ]; then
    echo "1. 품질 검사 스크립트 실행:"
    bash scripts/quality-check.sh || echo "품질 검사에서 이슈 발견"
    
    echo ""
    echo "2. 품질 수정 스크립트 실행:"
    if [ -f "scripts/quality-fix.sh" ]; then
        bash scripts/quality-fix.sh
        echo "✅ 품질 수정 스크립트 실행 완료"
    else
        echo "⚠️ quality-fix.sh 스크립트 없음"
    fi
    
else
    echo "⚠️ scripts/quality-check.sh 스크립트 없음"
    echo "수동으로 품질 검사 실행..."
    
    # 수동 품질 검사
    echo "Black 검사:"
    black --check test_quality/ || echo "포맷팅 필요"
    
    echo "isort 검사:"
    isort --check test_quality/ || echo "import 정렬 필요"
    
    echo "flake8 검사:"
    flake8 test_quality/ || echo "스타일 이슈 있음"
fi
```

### 4.2 품질 리포트 생성 테스트

```bash
echo "📊 품질 리포트 생성 테스트..."

if [ -f "scripts/generate_quality_report.py" ]; then
    echo "1. 품질 리포트 생성:"
    python scripts/generate_quality_report.py
    
    echo ""
    echo "2. 생성된 리포트 확인:"
    if ls reports/quality_report_*.json 1> /dev/null 2>&1; then
        latest_report=$(ls -t reports/quality_report_*.json | head -1)
        echo "✅ JSON 리포트 생성: $latest_report"
        
        # JSON 유효성 검사
        python -m json.tool "$latest_report" > /dev/null 2>&1
        if [ $? -eq 0 ]; then
            echo "✅ JSON 형식 유효"
        else
            echo "❌ JSON 형식 오류"
        fi
    fi
    
    if ls reports/quality_report_*.html 1> /dev/null 2>&1; then
        latest_html=$(ls -t reports/quality_report_*.html | head -1)
        echo "✅ HTML 리포트 생성: $latest_html"
    fi
    
else
    echo "⚠️ generate_quality_report.py 스크립트 없음"
fi
```

---

## 🎯 테스트 시나리오 5: Docker 환경 통합 테스트

### 5.1 Docker 컨테이너에서 품질 도구 테스트

```bash
echo "🐳 Docker 환경 품질 도구 테스트..."

if [ -f "Dockerfile.dev" ]; then
    echo "1. Docker 이미지 빌드:"
    docker build -f Dockerfile.dev -t movie-mlops-quality-test . > /dev/null 2>&1
    
    if [ $? -eq 0 ]; then
        echo "✅ Docker 이미지 빌드 성공"
        
        echo ""
        echo "2. 컨테이너에서 품질 도구 실행:"
        docker run --rm \
            -v "$(pwd):/workspace" \
            -w /workspace \
            movie-mlops-quality-test \
            bash -c "
                echo '🔍 Docker 환경에서 품질 검사'
                black --check test_quality/ 2>/dev/null || echo 'Black: 포맷팅 필요'
                isort --check test_quality/ 2>/dev/null || echo 'isort: 정렬 필요'
                flake8 test_quality/ 2>/dev/null || echo 'flake8: 스타일 이슈'
                echo '✅ Docker 환경 품질 검사 완료'
            "
        
        if [ $? -eq 0 ]; then
            echo "✅ Docker 환경 품질 도구 테스트 통과"
        else
            echo "❌ Docker 환경 품질 도구 테스트 실패"
        fi
        
        # 테스트용 이미지 정리
        docker rmi movie-mlops-quality-test > /dev/null 2>&1
        
    else
        echo "❌ Docker 이미지 빌드 실패"
    fi
else
    echo "⚠️ Dockerfile.dev를 찾을 수 없습니다. Docker 테스트 스킵"
fi
```

### 5.2 Docker Compose 서비스 테스트

```bash
echo "🐳 Docker Compose 품질 서비스 테스트..."

if [ -f "docker-compose.yml" ] && grep -q "code-quality" docker-compose.yml; then
    echo "1. Docker Compose 품질 서비스 실행:"
    docker-compose run --rm code-quality || echo "품질 서비스 실행 완료"
    
    echo ""
    echo "2. 품질 서비스 정리:"
    docker-compose down
    
    echo "✅ Docker Compose 품질 서비스 테스트 완료"
else
    echo "⚠️ Docker Compose 품질 서비스 설정 없음"
fi
```

---

## 🎯 테스트 시나리오 6: VSCode 통합 테스트

### 6.1 VSCode 설정 검증

```bash
echo "💻 VSCode 통합 설정 테스트..."

if [ -d ".vscode" ]; then
    echo "1. VSCode 설정 디렉터리 존재: ✅"
    
    if [ -f ".vscode/settings.json" ]; then
        echo "2. VSCode settings.json 존재: ✅"
        
        # 설정 내용 확인
        if grep -q "python.formatting.provider" .vscode/settings.json; then
            echo "  - Python 포맷터 설정: ✅"
        fi
        
        if grep -q "python.linting.flake8Enabled" .vscode/settings.json; then
            echo "  - Flake8 설정: ✅"
        fi
        
        if grep -q "editor.formatOnSave" .vscode/settings.json; then
            echo "  - 저장 시 포맷팅: ✅"
        fi
    else
        echo "2. VSCode settings.json 없음: ❌"
    fi
    
    if [ -f ".vscode/extensions.json" ]; then
        echo "3. VSCode 확장 프로그램 추천 설정: ✅"
        
        # 추천 확장 프로그램 확인
        if grep -q "ms-python.black-formatter" .vscode/extensions.json; then
            echo "  - Black 확장 프로그램: ✅"
        fi
        
        if grep -q "ms-python.flake8" .vscode/extensions.json; then
            echo "  - Flake8 확장 프로그램: ✅"
        fi
    else
        echo "3. VSCode 확장 프로그램 설정 없음: ❌"
    fi
    
else
    echo "❌ VSCode 설정 디렉터리 없음"
fi
```

---

## 🎯 테스트 시나리오 7: 성능 및 확장성 테스트

### 7.1 대용량 코드베이스 처리 테스트

```bash
echo "⚡ 성능 및 확장성 테스트..."

# 대용량 테스트 파일 생성
echo "1. 대용량 코드베이스 생성:"
mkdir -p test_quality/large_codebase

for i in {1..20}; do
    cat > "test_quality/large_codebase/module_$i.py" << EOF
"""Module $i for performance testing"""
import sys
import os
from typing import List, Dict, Optional

class TestClass$i:
    def __init__(self, value: int) -> None:
        self.value = value
    
    def process_data(self, data: List[Dict]) -> Optional[Dict]:
        result = {}
        for item in data:
            result[f"key_{item.get('id', 0)}"] = item.get('value', 0) * self.value
        return result if result else None
    
    def validate_input(self, data: Dict) -> bool:
        required_keys = ['id', 'value', 'timestamp']
        return all(key in data for key in required_keys)

def utility_function_$i(param1: str, param2: int = 10) -> str:
    return f"processed_{param1}_{param2}"

# Performance test function
def performance_test_$i():
    test_data = [{'id': j, 'value': j * 2} for j in range(100)]
    processor = TestClass$i($i)
    return processor.process_data(test_data)
EOF
done

echo "✅ 대용량 코드베이스 생성 완료 (20개 모듈)"

# 성능 측정
echo ""
echo "2. 품질 도구 성능 측정:"

start_time=$(date +%s)
black test_quality/large_codebase/ > /dev/null 2>&1
black_time=$(($(date +%s) - start_time))

start_time=$(date +%s)
isort test_quality/large_codebase/ > /dev/null 2>&1
isort_time=$(($(date +%s) - start_time))

start_time=$(date +%s)
flake8 test_quality/large_codebase/ > /dev/null 2>&1
flake8_time=$(($(date +%s) - start_time))

echo "📊 성능 측정 결과:"
echo "  - Black 실행 시간: ${black_time}초"
echo "  - isort 실행 시간: ${isort_time}초"
echo "  - flake8 실행 시간: ${flake8_time}초"

total_time=$((black_time + isort_time + flake8_time))
echo "  - 총 실행 시간: ${total_time}초"

if [ $total_time -lt 30 ]; then
    echo "✅ 성능 테스트 통과 (30초 이내)"
else
    echo "⚠️ 성능 개선 필요 (30초 초과)"
fi
```

---

## 🎯 테스트 시나리오 8: 오류 처리 및 복원력 테스트

### 8.1 비정상 상황 처리 테스트

```bash
echo "🛡️ 오류 처리 및 복원력 테스트..."

# 1. 문법 오류가 있는 파일 처리
echo "1. 문법 오류 파일 처리 테스트:"
cat > test_quality/syntax_error.py << 'EOF'
# This file has syntax errors
def function_with_syntax_error(
    # Missing closing parenthesis
    
class IncompleteClass
    # Missing colon
    pass

# Indentation error
def another_function():
pass
EOF

# 각 도구가 문법 오류를 어떻게 처리하는지 테스트
echo "Black 처리:"
black test_quality/syntax_error.py 2>&1 | head -3 || echo "Black: 문법 오류 감지"

echo "flake8 처리:"
flake8 test_quality/syntax_error.py 2>&1 | head -3 || echo "flake8: 문법 오류 감지"

# 2. 권한 문제 시뮬레이션
echo ""
echo "2. 파일 권한 문제 테스트:"
echo "readonly content" > test_quality/readonly.py
chmod 444 test_quality/readonly.py

black test_quality/readonly.py 2>&1 | head -3 || echo "Black: 권한 문제 처리"

# 권한 복구
chmod 644 test_quality/readonly.py

# 3. 빈 디렉터리 처리
echo ""
echo "3. 빈 디렉터리 처리 테스트:"
mkdir -p test_quality/empty_dir

black test_quality/empty_dir/ || echo "Black: 빈 디렉터리 처리"
isort test_quality/empty_dir/ || echo "isort: 빈 디렉터리 처리"
flake8 test_quality/empty_dir/ || echo "flake8: 빈 디렉터리 처리"

echo "✅ 오류 처리 테스트 완료"
```

---

## 🎯 테스트 시나리오 9: 통합 시나리오 테스트

### 9.1 실제 개발 워크플로우 시뮬레이션

```bash
echo "🔄 실제 개발 워크플로우 시뮬레이션..."

# 새로운 기능 개발 시나리오
echo "1. 새 기능 개발 브랜치 생성:"
git checkout -b test/code-quality-workflow

# 새 기능 코드 작성 (초기에는 품질 문제 있음)
cat > test_quality/new_feature.py << 'EOF'
import sys,os
from typing import List

def new_feature_function(data,options=None):
    if not data:return None
    result=[]
    for item in data:
        if options and 'filter' in options:
            if item.get('status')!=options['filter']:continue
        processed={'id':item['id'],'processed_value':item['value']*2}
        result.append(processed)
    return result

class NewFeatureProcessor:
    def __init__(self,config):
        self.config=config
    def process(self,items):
        return[self.transform(item)for item in items if self.validate(item)]
    def validate(self,item):
        return 'id'in item and'value'in item
    def transform(self,item):
        return{'id':item['id'],'result':item['value']*self.config.get('multiplier',1)}
EOF

echo "2. 코드 품질 검사 실행:"
echo "초기 품질 상태:"
black --check test_quality/new_feature.py || echo "포맷팅 필요"
isort --check test_quality/new_feature.py || echo "import 정렬 필요"
flake8 test_quality/new_feature.py || echo "스타일 이슈"

echo ""
echo "3. 코드 품질 자동 개선:"
black test_quality/new_feature.py
isort test_quality/new_feature.py

echo ""
echo "4. 개선 후 품질 재검사:"
black --check test_quality/new_feature.py && echo "✅ Black 통과"
isort --check test_quality/new_feature.py && echo "✅ isort 통과"
flake8 test_quality/new_feature.py && echo "✅ flake8 통과" || echo "⚠️ flake8 일부 이슈"

echo ""
echo "5. 타입 힌트 개선 (수동):"
# 타입 힌트 개선된 버전으로 교체
cat > test_quality/new_feature.py << 'EOF'
import os
import sys
from typing import Dict, List, Optional


def new_feature_function(
    data: List[Dict], options: Optional[Dict] = None
) -> Optional[List[Dict]]:
    if not data:
        return None
    result = []
    for item in data:
        if options and "filter" in options:
            if item.get("status") != options["filter"]:
                continue
        processed = {"id": item["id"], "processed_value": item["value"] * 2}
        result.append(processed)
    return result


class NewFeatureProcessor:
    def __init__(self, config: Dict) -> None:
        self.config = config

    def process(self, items: List[Dict]) -> List[Dict]:
        return [self.transform(item) for item in items if self.validate(item)]

    def validate(self, item: Dict) -> bool:
        return "id" in item and "value" in item

    def transform(self, item: Dict) -> Dict:
        return {
            "id": item["id"],
            "result": item["value"] * self.config.get("multiplier", 1),
        }
EOF

echo ""
echo "6. 최종 품질 검증:"
black --check test_quality/new_feature.py && echo "✅ Black 최종 통과"
isort --check test_quality/new_feature.py && echo "✅ isort 최종 통과" 
flake8 test_quality/new_feature.py && echo "✅ flake8 최종 통과" || echo "⚠️ 일부 flake8 이슈"
mypy test_quality/new_feature.py && echo "✅ MyPy 최종 통과" || echo "⚠️ 일부 타입 이슈"

echo ""
echo "7. Git 커밋 시도 (pre-commit hook 테스트):"
git add test_quality/new_feature.py
git commit -m "feat: add new feature with proper code quality" || echo "Pre-commit hook 검증 완료"

# 원래 브랜치로 돌아가기
git checkout main 2>/dev/null || git checkout master 2>/dev/null || true
git branch -D test/code-quality-workflow 2>/dev/null || true

echo "✅ 개발 워크플로우 시뮬레이션 완료"
```

---

## 🎯 테스트 시나리오 10: 정리 및 최종 검증

### 10.1 테스트 환경 정리

```bash
echo "🧹 테스트 환경 정리..."

# 테스트 파일들 정리
rm -rf test_quality/
rm -f test_security_report.json
rm -rf reports/ 2>/dev/null || true

echo "✅ 테스트 환경 정리 완료"
```

### 10.2 최종 검증 및 요약

```bash
echo "📊 최종 검증 및 테스트 요약..."

# 필수 도구들이 여전히 설치되어 있는지 확인
echo "🔍 최종 도구 설치 상태 확인:"
essential_tools=("black" "isort" "flake8" "mypy" "pre-commit")
all_installed=true

for tool in "${essential_tools[@]}"; do
    if command -v "$tool" &> /dev/null; then
        echo "✅ $tool: 설치됨"
    else
        echo "❌ $tool: 설치되지 않음"
        all_installed=false
    fi
done

# 설정 파일 최종 확인
echo ""
echo "⚙️ 설정 파일 최종 확인:"
config_check=true

if [ -f "pyproject.toml" ]; then
    echo "✅ pyproject.toml 존재"
else
    echo "❌ pyproject.toml 없음"
    config_check=false
fi

if [ -f ".pre-commit-config.yaml" ]; then
    echo "✅ .pre-commit-config.yaml 존재"
else
    echo "❌ .pre-commit-config.yaml 없음"
    config_check=false
fi

# 전체 테스트 결과 요약
echo ""
if $all_installed && $config_check; then
    echo "🎉 3.5 Code Quality Tools Configuration 테스트 완료!"
    echo ""
    echo "✅ 통과한 테스트들:"
    echo "  - 코드 품질 도구 설치 및 설정"
    echo "  - Black 포맷터 기능"
    echo "  - isort import 정렬 기능"
    echo "  - flake8 스타일 검사"
    echo "  - MyPy 타입 체킹"
    echo "  - Bandit 보안 검사"
    echo "  - Pre-commit Hook 통합"
    echo "  - 자동화 스크립트"
    echo "  - Docker 환경 통합"
    echo "  - VSCode 통합"
    echo "  - 성능 및 확장성"
    echo "  - 오류 처리 및 복원력"
    echo "  - 실제 개발 워크플로우"
    echo ""
    echo "🚀 코드 품질 도구가 정상적으로 구성되었습니다!"
    echo "💡 이제 일관된 코드 품질 관리가 가능합니다."
else
    echo ""
    echo "❌ 일부 테스트에서 문제가 발견되었습니다."
    echo "🔧 위의 오류를 해결한 후 다시 테스트해 주세요."
fi
```

---

## 📋 테스트 체크리스트

### 필수 테스트 항목
- [ ] 모든 코드 품질 도구 설치 확인
- [ ] Black 포맷터 정상 작동
- [ ] isort import 정렬 정상 작동
- [ ] flake8 스타일 검사 정상 작동
- [ ] MyPy 타입 체킹 정상 작동
- [ ] Bandit 보안 검사 정상 작동
- [ ] Pre-commit Hook 정상 작동
- [ ] 자동화 스크립트 정상 작동

### 통합 테스트 항목
- [ ] Docker 환경에서 정상 작동
- [ ] VSCode 통합 설정 확인
- [ ] 실제 개발 워크플로우 시뮬레이션
- [ ] Git 커밋 프로세스 통합

### 성능 테스트 항목
- [ ] 대용량 코드베이스 처리 (30초 이내)
- [ ] 메모리 사용량 합리적 수준
- [ ] 동시 실행 가능성
- [ ] 확장 가능한 구조

### 오류 처리 테스트 항목
- [ ] 문법 오류 파일 적절한 처리
- [ ] 권한 문제 적절한 처리
- [ ] 빈 디렉터리 적절한 처리
- [ ] 복구 메커니즘 동작

---

## 🔧 문제 해결 가이드

### 일반적인 문제들

**Q: 패키지 설치 오류**
```bash
# 가상환경 재생성
rm -rf venv/
python -m venv venv
source venv/bin/activate
pip install -r docs/03-version-control/requirements-dev.txt
```

**Q: Pre-commit 설치 실패**
```bash
# Pre-commit 재설치
pip uninstall pre-commit
pip install pre-commit
pre-commit clean
pre-commit install
```

**Q: Black 포맷팅 오류**
```bash
# Black 설정 확인
black --version
black --help
# pyproject.toml 설정 확인
```

**Q: Docker 환경 오류**
```bash
# Docker 서비스 재시작
sudo service docker restart
# Docker 이미지 재빌드
docker build --no-cache -f Dockerfile.dev -t test-image .
```

---

이 테스트 가이드를 통해 3.5 Code Quality Tools Configuration의 모든 기능이 정상적으로 작동하는지 체계적으로 검증할 수 있습니다.
